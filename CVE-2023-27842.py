#!/usr/bin/python3

from pwn import *
import sys
import requests

class ExploitExtplorer:

    def __init__(self,url,username,password,command="whoami"):
        self.url = url
        self.username = username
        self.password = password
        self.command = command
        self.p = log.progress("")

    def check_version(self):
        r = requests.get(self.url+"CHANGELOG.txt")
        text = r.text[97:103]
        if text == "2.1.15":
            self.p.status("Target is vulnerable!!")
        else:
            self.p.status("Target is not vulnerable!!")

if __name__ == "__main__":

    if len(sys.argv) != 4:
        # Add function that handles arguments here
        error(f"Usage: {sys.argv[0]} url username password")

    if len(sys.argv) == 4:
        exploit = ExploitExtplorer(sys.argv[1],sys.argv[2],sys.argv[3])

    exploit.check_version()

